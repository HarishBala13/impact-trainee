package comdulcetapplication;

import java.sql.SQLException;

/*
@title			Dulcet - Music Player
@author			Harish B
@createdOn		28-11-2024
@modifiedOn		-
@reviewedBy		-
@reviewedOn		-
*/

public class Dulcet {
	
	static boolean isApplicationExited = false;

	static void loadApplication(Object userManager, Object songManager) {
		
		// Loading the SQL Connection before the application starts
		try {
			SQL_Connector.getSqlClassConnection();	
			SQL_Connector.getSqlConnection();
		} 
		catch (ClassNotFoundException classNotFoundException) {
			classNotFoundException.printStackTrace();
		}
		 catch (SQLException sqlException) {
			sqlException.printStackTrace();
		}
		
		// Declaring loggedIn boolean to check the user
		 boolean loggedIn = ((AccountManager) userManager).start();
	        
	    // If loggedIn returns true user is logged otherwise with a small refresh and next to the same page

	        if (loggedIn) {
	            System.out.println("Login successful! Enjoy our Music Player.");
	            ((SongManager) songManager).start();
	        } else if(!loggedIn) {
				try {
	            	Thread.sleep(500);	
	      			loadApplication(songManager, songManager);
				} catch (InterruptedException login_interrupted) {
					Thread.currentThread().interrupt();
					System.err.println("Login interrupted for the user with wrong credentials");
				}
	            if(isApplicationExited) {	            	
	            	Dulcet.main(null);
	            }
	        }
	}

	public static void main(String[] args) {

		 // Create objects for the controller of User and Song    
	        AccountManager userManager = new AccountManager();
	        SongManager songManager = new SongManager(); 

		// Welcome page of the Application
		 	Welcome.showWelcomePage();
		 	
		// Loading animation for initializing of the application
	        LoadingAnimation.showLoading("Initializing Music Player...");

		// Starting application method call after the small loading
	        loadApplication(userManager, songManager);	    
	}
}

/**
 * 
    System.out.println("Exiting application.");
	Welcome.showExitMessage();
	    try {
	       	Thread.sleep(500);	
	       	isApplicationExited = false;
		} catch (InterruptedException app_interupted) {
			Thread.currentThread().interrupt();
			isApplicationExited = true;
			System.err.println("Application closing interrupted!"+app_interupted.getMessage());					
		}
 */